{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/src/components/addContent.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Joi from 'joi';\nimport jwtDecode from 'jwt-decode';\nimport AddTopicos from './addTopicos';\n\nclass AddContent extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      content: {\n        conteudo: '',\n        resposta: '',\n        _id: ''\n      },\n      listSelector: ''\n    };\n\n    this.splitTopicosList = catalogo => {\n      let listaDeTopicos = [];\n\n      for (let i = 0; i < catalogo.length; i++) {\n        if (!listaDeTopicos.includes(catalogo[i].topico)) {\n          listaDeTopicos.push(catalogo[i].topico);\n        }\n      }\n\n      return listaDeTopicos;\n    };\n\n    this.handleSubmit = async e => {\n      const backEndPoint = process.env.REACT_APP_API_URL;\n      e.preventDefault();\n\n      try {\n        const result = await axios.put(backEndPoint + '/topicos/addContent', this.state.content, {\n          headers: {\n            'x-auth-token': localStorage.getItem('token')\n          }\n        });\n        alert(\"Conteúdo inserido com sucesso.\");\n      } catch (ex) {\n        alert(ex);\n      }\n    };\n\n    this.handleChange = e => {\n      const newForm = { ...this.state.content\n      };\n      newForm[e.currentTarget.name] = e.currentTarget.value;\n      this.setState({\n        content: newForm\n      });\n    };\n\n    this.handleListChange = e => {\n      let newForm = { ...this.state.conteudo\n      };\n      this.setState({\n        listSelector: e.currentTarget.value\n      });\n      console.log(newForm);\n      const topic = this.props.catalogos.filter(c => c.topico === e.currentTarget.value);\n      newForm._id = topic[0]._id;\n      console.log(newForm);\n      this.setState({\n        content: newForm\n      });\n    };\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem('token');\n    const user = jwtDecode(token);\n\n    if (!user.isAdmin) {\n      alert('Você não tem permissão para acessar esta página.');\n      this.props.history.push(\"/\");\n    }\n  }\n\n  render() {\n    const topicos = this.splitTopicosList(this.props.catalogos);\n\n    if (!this.props.visibilidade) {\n      return;\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addTopicos\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Tela de adi\\xE7\\xE3o de conte\\xFAdo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"addForm\",\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addItem\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"chooseTopic\",\n            children: \"Lista de t\\xF3picos atuais\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            list: \"topicList\",\n            onChange: this.handleListChange,\n            value: this.state.listSelector,\n            name: \"chooseTopic\",\n            className: \"addInput\",\n            type: \"text\",\n            id: \"chooseTopic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n            id: \"topicList\",\n            children: topicos.map(topico => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: topico\n            }, topicos.indexOf(topico), false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 53\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addItem\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"conteudo\",\n            children: \"Conteudo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"conteudo\",\n            value: this.state.content.conteudo,\n            onChange: this.handleChange,\n            className: \"addInput\",\n            type: \"text\",\n            id: \"conteudo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addItem\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"resposta\",\n            children: \"Resposta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"resposta\",\n            value: this.state.content.resposta,\n            onChange: this.handleChange,\n            className: \"addInput\",\n            type: \"text\",\n            id: \"resposta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"addItem\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"submitBtn\",\n            type: \"submit\",\n            value: \"Salvar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default AddContent;","map":{"version":3,"sources":["/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/src/components/addContent.jsx"],"names":["React","Component","axios","Joi","jwtDecode","AddTopicos","AddContent","state","content","conteudo","resposta","_id","listSelector","splitTopicosList","catalogo","listaDeTopicos","i","length","includes","topico","push","handleSubmit","e","backEndPoint","process","env","REACT_APP_API_URL","preventDefault","result","put","headers","localStorage","getItem","alert","ex","handleChange","newForm","currentTarget","name","value","setState","handleListChange","console","log","topic","props","catalogos","filter","c","componentDidMount","token","user","isAdmin","history","render","topicos","visibilidade","map","indexOf"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Joi from 'joi';\nimport jwtDecode from 'jwt-decode';\nimport AddTopicos from './addTopicos';\n\nclass AddContent extends Component {\n\n    state = {\n        content:{\n            conteudo:'',\n            resposta:'',\n            _id:''\n        },\n\n        listSelector:''\n    }\n\n    componentDidMount() {\n\n        const token = localStorage.getItem('token');\n        const user = jwtDecode(token);\n        if(!user.isAdmin){\n            alert('Você não tem permissão para acessar esta página.');\n            this.props.history.push(\"/\");\n        }\n\n       \n    }\n\n    splitTopicosList = (catalogo) => {\n\n        let listaDeTopicos = [];\n\n        for(let i = 0; i<catalogo.length; i++){\n            if(!listaDeTopicos.includes(catalogo[i].topico) ){\n                listaDeTopicos.push(catalogo[i].topico);\n            }\n        }\n        return listaDeTopicos;\n    }\n\n    /*\n\n    validateEnter(topico){\n\n        const schema = Joi.object({\n            content: Joi.array()\n           \n        });\n    \n        return schema.validate(topico);\n    }\n\n    */\n\n    handleSubmit = async e => {\n        const backEndPoint = process.env.REACT_APP_API_URL;\n\n        e.preventDefault();\n\n        \n        try{\n            const result  = await axios.put(backEndPoint+'/topicos/addContent', this.state.content, {\n            headers:{\n                'x-auth-token': localStorage.getItem('token')\n            }\n        });\n            alert(\"Conteúdo inserido com sucesso.\");\n        }\n        catch(ex){\n\n            alert(ex);\n\n        }\n        \n        \n    }\n\n    handleChange = e => {\n        const newForm = {...this.state.content};\n    \n        newForm[e.currentTarget.name] = e.currentTarget.value;\n\n        this.setState({content:newForm});\n    }\n\n\n\n\n    handleListChange = e => {\n\n        let newForm = {...this.state.conteudo};\n\n        this.setState({listSelector:e.currentTarget.value});\n\n        console.log(newForm);\n        \n        const topic = this.props.catalogos.filter(c => c.topico === e.currentTarget.value);\n        \n        newForm._id = topic[0]._id;\n\n        console.log(newForm);\n        \n        this.setState({content:newForm});\n        \n    }\n\n\n\n\n\n\n    render() { \n        const topicos = this.splitTopicosList(this.props.catalogos);\n\n        if(!this.props.visibilidade){\n            return;\n        }\n\n        return ( \n\n            <div className = \"addTopicos\">\n                <h2>Tela de adição de conteúdo</h2>\n                \n                <form className = \"addForm\" onSubmit ={this.handleSubmit}>\n                    <div className=\"addItem\">\n                        <label htmlFor=\"chooseTopic\">Lista de tópicos atuais</label>\n                        <input list = 'topicList' onChange = {this.handleListChange} value = {this.state.listSelector} name = 'chooseTopic' className = \"addInput\" type=\"text\" id=\"chooseTopic\" />\n                        <datalist id = 'topicList'>\n                            {topicos.map((topico)=> <option key = {topicos.indexOf(topico)} value = {topico}/>\n                            )}\n                        </datalist>\n                    </div>\n\n\n                    <div className=\"addItem\">\n                        <label htmlFor=\"conteudo\">Conteudo</label>\n                        <input name = 'conteudo'  value = {this.state.content.conteudo} onChange = {this.handleChange}  className = \"addInput\" type=\"text\" id=\"conteudo\"/>\n                    </div>\n\n                    <div className=\"addItem\">\n                        <label htmlFor=\"resposta\">Resposta</label>\n                        <input name = 'resposta' value = {this.state.content.resposta}  onChange = {this.handleChange}  className = \"addInput\"  type=\"text\" id=\"resposta\" />\n                    </div>\n\n                    <div className=\"addItem\">\n                        <input className = \"submitBtn\" type=\"submit\" value=\"Salvar\"/>\n                    </div>\n                    \n                </form>\n            </div>\n         );\n    }\n}\n \nexport default AddContent;"]},"metadata":{},"sourceType":"module"}