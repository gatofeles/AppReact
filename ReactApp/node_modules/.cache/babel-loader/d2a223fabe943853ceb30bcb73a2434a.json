{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import Joi from'joi';import jwtDecode from'jwt-decode';import AddTopicos from'./addTopicos';var AddContent=/*#__PURE__*/function(_Component){_inherits(AddContent,_Component);var _super=_createSuper(AddContent);function AddContent(){var _this;_classCallCheck(this,AddContent);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={content:{conteudo:'',resposta:'',_id:''},listSelector:''};_this.splitTopicosList=function(catalogo){var listaDeTopicos=[];for(var i=0;i<catalogo.length;i++){if(!listaDeTopicos.includes(catalogo[i].topico)){listaDeTopicos.push(catalogo[i].topico);}}return listaDeTopicos;};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var backEndPoint,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:backEndPoint=process.env.REACT_APP_API_URL;e.preventDefault();_context.prev=2;_context.next=5;return axios.put(backEndPoint+'/topicos/addContent',_this.state.content,{headers:{'x-auth-token':localStorage.getItem('token')}});case 5:result=_context.sent;alert(\"Conteúdo inserido com sucesso.\");_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);alert(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleChange=function(e){var newForm=_objectSpread({},_this.state.content);newForm[e.currentTarget.name]=e.currentTarget.value;_this.setState({content:newForm});};_this.handleListChange=function(e){var newForm=_objectSpread({},_this.state.conteudo);_this.setState({listSelector:e.currentTarget.value});console.log(newForm);var topic=_this.props.catalogos.filter(function(c){return c.topico===e.currentTarget.value;});newForm._id=topic[0]._id;console.log(newForm);_this.setState({content:newForm});};return _this;}_createClass(AddContent,[{key:\"componentDidMount\",value:function componentDidMount(){var token=localStorage.getItem('token');var user=jwtDecode(token);if(!user.isAdmin){alert('Você não tem permissão para acessar esta página.');this.props.history.push(\"/\");}}},{key:\"render\",value:function render(){var topicos=this.splitTopicosList(this.props.catalogos);if(!this.props.visibilidade){return true;}return/*#__PURE__*/_jsxs(\"div\",{className:\"addTopicos\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Tela de adi\\xE7\\xE3o de conte\\xFAdo\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"addForm\",onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"addItem\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"chooseTopic\",children:\"Lista de t\\xF3picos atuais\"}),/*#__PURE__*/_jsx(\"input\",{list:\"topicList\",onChange:this.handleListChange,value:this.state.listSelector,name:\"chooseTopic\",className:\"addInput\",type:\"text\",id:\"chooseTopic\"}),/*#__PURE__*/_jsx(\"datalist\",{id:\"topicList\",children:topicos.map(function(topico){return/*#__PURE__*/_jsx(\"option\",{value:topico},topicos.indexOf(topico));})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"addItem\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"conteudo\",children:\"Conteudo\"}),/*#__PURE__*/_jsx(\"input\",{name:\"conteudo\",value:this.state.content.conteudo,onChange:this.handleChange,className:\"addContent\",type:\"text\",id:\"conteudo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"addItem\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"resposta\",children:\"Resposta\"}),/*#__PURE__*/_jsx(\"input\",{name:\"resposta\",value:this.state.content.resposta,onChange:this.handleChange,className:\"addAnswer\",type:\"text\",id:\"resposta\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"addItem\",children:/*#__PURE__*/_jsx(\"input\",{className:\"submitBtn\",type:\"submit\",value:\"Salvar\"})})]})]});}}]);return AddContent;}(Component);export default AddContent;","map":{"version":3,"sources":["/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/src/components/addContent.jsx"],"names":["React","Component","axios","Joi","jwtDecode","AddTopicos","AddContent","state","content","conteudo","resposta","_id","listSelector","splitTopicosList","catalogo","listaDeTopicos","i","length","includes","topico","push","handleSubmit","e","backEndPoint","process","env","REACT_APP_API_URL","preventDefault","put","headers","localStorage","getItem","result","alert","handleChange","newForm","currentTarget","name","value","setState","handleListChange","console","log","topic","props","catalogos","filter","c","token","user","isAdmin","history","topicos","visibilidade","map","indexOf"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Joi from 'joi';\nimport jwtDecode from 'jwt-decode';\nimport AddTopicos from './addTopicos';\n\nclass AddContent extends Component {\n\n    state = {\n        content:{\n            conteudo:'',\n            resposta:'',\n            _id:''\n        },\n\n        listSelector:''\n    }\n\n    componentDidMount() {\n\n        const token = localStorage.getItem('token');\n        const user = jwtDecode(token);\n        if(!user.isAdmin){\n            alert('Você não tem permissão para acessar esta página.');\n            this.props.history.push(\"/\");\n        }\n\n       \n    }\n\n    splitTopicosList = (catalogo) => {\n\n        let listaDeTopicos = [];\n\n        for(let i = 0; i<catalogo.length; i++){\n            if(!listaDeTopicos.includes(catalogo[i].topico) ){\n                listaDeTopicos.push(catalogo[i].topico);\n            }\n        }\n        return listaDeTopicos;\n    }\n\n    /*\n\n    validateEnter(topico){\n\n        const schema = Joi.object({\n            content: Joi.array()\n           \n        });\n    \n        return schema.validate(topico);\n    }\n\n    */\n\n    handleSubmit = async e => {\n        const backEndPoint = process.env.REACT_APP_API_URL;\n\n        e.preventDefault();\n\n        \n        try{\n            const result  = await axios.put(backEndPoint+'/topicos/addContent', this.state.content, {\n            headers:{\n                'x-auth-token': localStorage.getItem('token')\n            }\n        });\n            alert(\"Conteúdo inserido com sucesso.\");\n        }\n        catch(ex){\n\n            alert(ex);\n\n        }\n        \n        \n    }\n\n    handleChange = e => {\n        const newForm = {...this.state.content};\n    \n        newForm[e.currentTarget.name] = e.currentTarget.value;\n\n        this.setState({content:newForm});\n    }\n\n\n\n\n    handleListChange = e => {\n\n        let newForm = {...this.state.conteudo};\n\n        this.setState({listSelector:e.currentTarget.value});\n\n        console.log(newForm);\n        \n        const topic = this.props.catalogos.filter(c => c.topico === e.currentTarget.value);\n        \n        newForm._id = topic[0]._id;\n\n        console.log(newForm);\n        \n        this.setState({content:newForm});\n        \n    }\n\n\n\n\n\n\n    render() { \n        const topicos = this.splitTopicosList(this.props.catalogos);\n\n        if(!this.props.visibilidade){\n            return true;\n        }\n\n        return ( \n\n            <div className = \"addTopicos\">\n                <h2>Tela de adição de conteúdo</h2>\n                \n                <form className = \"addForm\" onSubmit ={this.handleSubmit}>\n                    <div className=\"addItem\">\n                        <label htmlFor=\"chooseTopic\">Lista de tópicos atuais</label>\n                        <input list = 'topicList' onChange = {this.handleListChange} value = {this.state.listSelector} name = 'chooseTopic' className = \"addInput\" type=\"text\" id=\"chooseTopic\" />\n                        <datalist id = 'topicList'>\n                            {topicos.map((topico)=> <option key = {topicos.indexOf(topico)} value = {topico}/>\n                            )}\n                        </datalist>\n                    </div>\n\n\n                    <div className=\"addItem\">\n                        <label htmlFor=\"conteudo\">Conteudo</label>\n                        <input name = 'conteudo'  value = {this.state.content.conteudo} onChange = {this.handleChange}  className = \"addContent\" type=\"text\" id=\"conteudo\"/>\n                    </div>\n\n                    <div className=\"addItem\">\n                        <label htmlFor=\"resposta\">Resposta</label>\n                        <input name = 'resposta' value = {this.state.content.resposta}  onChange = {this.handleChange}  className = \"addAnswer\"  type=\"text\" id=\"resposta\" />\n                    </div>\n\n                    <div className=\"addItem\">\n                        <input className = \"submitBtn\" type=\"submit\" value=\"Salvar\"/>\n                    </div>\n                    \n                </form>\n            </div>\n         );\n    }\n}\n \nexport default AddContent;"]},"metadata":{},"sourceType":"module"}