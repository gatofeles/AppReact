{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import images from'../static/utils/images';import'../static/css/login.css';import axios from'axios';import Joi from'joi';var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(){var _this;_classCallCheck(this,Login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:{userName:'',password:''}};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var blankUser,valid,backEndPoint,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:blankUser={userName:'',password:''};e.preventDefault();console.log(e.nativeEvent.submitter.id);if(!(e.nativeEvent.submitter.id==='loginBtn')){_context.next=26;break;}valid=_this.validateUser(_this.state.user);if(!valid.error){_context.next=10;break;}alert(valid.error.message);_this.setState({user:blankUser});_context.next=24;break;case 10:_context.prev=10;//TODO: Setar o endereço do backend em config\nbackEndPoint=\"https://morning-plains-43576.herokuapp.com/api\";_context.next=14;return axios.post(backEndPoint+'/login',_this.state.user);case 14:result=_context.sent;console.log(result.headers);localStorage.setItem('token',result.data);_this.props.history.push(\"/\");_context.next=24;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](10);alert('Usuário ou senha inválidos.');console.log(_context.t0);case 24:_context.next=27;break;case 26:_this.props.history.push(\"/register\");case 27:case\"end\":return _context.stop();}}},_callee,null,[[10,20]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleChange=function(e){var newUser=_objectSpread({},_this.state.user);newUser[e.currentTarget.name]=e.currentTarget.value;_this.setState({user:newUser});};return _this;}_createClass(Login,[{key:\"validateUser\",value:function validateUser(user){var schema=Joi.object({userName:Joi.string().max(70).min(3).required(),password:Joi.string().max(70).min(3).required()});return schema.validate(user);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"containerLogin\",children:[/*#__PURE__*/_jsx(\"img\",{id:\"loginImage\",src:images.login,alt:\"Logo\"}),/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"Oi Luigi!\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"userName\",children:\"Usu\\xE1rio\"}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handleChange,className:\"loginInput\",type:\"text\",id:\"fname\",name:\"userName\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"senha\",children:\"Senha\"}),/*#__PURE__*/_jsx(\"input\",{onChange:this.handleChange,className:\"loginInput\",type:\"text\",id:\"senha\",name:\"password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"loginBtn\",className:\"submitBtn\",type:\"submit\",value:\"Entrar\"}),/*#__PURE__*/_jsx(\"input\",{id:\"registerBtn\",className:\"submitBtn\",type:\"submit\",value:\"Registrar\"})]})]})]});}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["/home/gatofeles/Documentos/oiLuigi/oiLuigiNode/frontend/luigi/src/components/login.jsx"],"names":["React","Component","images","axios","Joi","Login","state","user","userName","password","handleSubmit","e","blankUser","preventDefault","console","log","nativeEvent","submitter","id","valid","validateUser","error","alert","message","setState","backEndPoint","post","result","headers","localStorage","setItem","data","props","history","push","handleChange","newUser","currentTarget","name","value","schema","object","string","max","min","required","validate","login"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport images from '../static/utils/images';\nimport '../static/css/login.css'\nimport axios from 'axios';\nimport Joi from 'joi';\n\nclass Login extends Component {\n\n    state = { user:{\n        userName:'',\n        password:''\n    }}\n\n    validateUser(user){\n        const schema = Joi.object({\n            userName: Joi.string().max(70).min(3).required(),\n            password: Joi.string().max(70).min(3).required(),\n            \n        });\n    \n        return schema.validate(user);\n    }\n\n\n    handleSubmit = async e => {\n\n        const blankUser = {\n            userName : '',\n            password : ''\n        };\n\n        e.preventDefault();\n\n        console.log(e.nativeEvent.submitter.id);\n\n        if(e.nativeEvent.submitter.id === 'loginBtn'){\n       \n            const valid = this.validateUser(this.state.user);\n        \n            if(valid.error){\n                alert(valid.error.message);\n                this.setState({user:blankUser});\n            }\n        \n            else{\n\n                try{\n                    //TODO: Setar o endereço do backend em config\n                    const backEndPoint = \"https://morning-plains-43576.herokuapp.com/api\";\n                    const result  = await axios.post(backEndPoint+'/login', this.state.user);\n                    console.log(result.headers);\n                    localStorage.setItem('token', result.data);\n                    this.props.history.push(\"/\");\n                }\n                catch(e){\n                    alert('Usuário ou senha inválidos.');\n                    console.log(e);\n                } \n            }\n        }\n\n        else{\n            this.props.history.push(\"/register\");\n        }\n    }\n\n\n    handleChange = e => {\n        const newUser = {...this.state.user};\n\n        newUser[e.currentTarget.name] = e.currentTarget.value;\n\n        this.setState({user:newUser});\n    }\n\n\n    render() { \n        return (  \n        <div className=\"containerLogin\">\n            <img id = \"loginImage\" src={images.login} alt=\"Logo\"/>\n            <div className=\"title\">Oi Luigi!</div>\n                <form className=\"form\" onSubmit ={this.handleSubmit}>\n                    <label htmlFor=\"userName\">Usuário</label>\n                    <input onChange = {this.handleChange} className = \"loginInput\" type=\"text\" id=\"fname\" name=\"userName\"/>\n                    <label htmlFor=\"senha\">Senha</label>\n                    <input onChange = {this.handleChange} className = \"loginInput\" type=\"text\" id=\"senha\" name=\"password\"/>\n                <div className=\"buttons\">\n                    <input id = 'loginBtn' className = \"submitBtn\" type=\"submit\" value=\"Entrar\"/>\n                    <input id = 'registerBtn' className = \"submitBtn\" type=\"submit\" value=\"Registrar\"/>\n                </div>\n                </form>\n        </div>\n    \n        );\n    }\n}\n \nexport default Login;"]},"metadata":{},"sourceType":"module"}